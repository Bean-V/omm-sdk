import{d as de,r as d,T as re,e as ve,C as _e,f as u,o as c,l as f,z as s,h as i,j as v,a0 as L,Z as h,W as N,F as he,D as fe,n as m,af as pe,ag as ge,R as E,ah as me,P as ye,p as ke,k as ze,g as k,t as y,_ as be}from"./index-24b7b5a4.js";import{f as xe}from"./custom-f463eef0.js";import{E as we}from"./403-7bfaf254.js";const I=V=>(ke("data-v-c4e5d4f7"),V=V(),ze(),V),je={class:"page"},Ve={style:{padding:"5px 16px",display:"flex","justify-content":"space-around"}},Ce={key:0},qe=I(()=>v("div",{style:{"text-align":"center",color:"var(--el-text-color-secondary)"}},"无权限访问！",-1)),Ae={key:1},Se={key:0},Re={key:0,class:"error-message"},Ee={key:1,class:"list"},Ie={class:"cell_custom_title"},Ue={class:"cell_custom_title"},De=I(()=>v("span",null,"接收单位",-1)),Pe={class:"cell_custom_title"},Be=I(()=>v("span",null,"上报单位",-1)),Le={key:0,slot:"finished"},x=10,w=1,j=0,Ne=de({name:"hcfk_check_list",__name:"check_list",setup(V){const n=d({}),U=d(null),T=d([{text:"核查",value:"核查"},{text:"防范",value:"防范"},{text:"预警",value:"预警"},{text:"关注",value:"关注"}]),G=d([{text:"部门采",value:"部采"},{text:"部门采(州)",value:"部采州"},{text:"县（市）采",value:"市采"},{text:"州采",value:"州采"}]),p=d(!1),r=d(!1),t=re({size:x,current:w,total:j}),O=ve(()=>t.size*t.current-t.size),z=d([]),C=d(!0),R=d(!1),Z=async()=>{t.size=x,t.current=w,t.total=j,r.value=!1,z.value=[],n.value?A():q()},$=()=>{n.value={}},F=e=>{t.size=x,t.current=w,t.total=j,r.value=!1,A()},W=()=>{debugger;t.size=x,t.current=w,t.total=j,r.value=!1,A()},D=d(null),J=()=>{t.size=x,t.current=w,t.total=j,r.value=!1,D.value.toggle(),A()};function q(){p.value=!0,pe({num:t.size,start:O.value}).then(e=>{if(r.value=!0,e.rows&&Array.isArray(e.rows)){const a=e.rows.map(o=>({bianhao:o.bianhao,biaoti:o.biaoti,chizhileix:o.chizhileix,db:o.db,duquren:o.duquren,duqurensfz:o.duqurensfz,duqushijian:o.duqushijian,hechazhuangtai:o.hechazhuangtai,id:o.id,leixing:o.leixing,sbzzjgdm:o.sbzzjgdm,sbzzjgmc:o.sbzzjgmc,sfzhmsbr:o.sfzhmsbr,shifoucaiyong:o.shifoucaiyong,shifouguidang:o.shifouguidang,shrq:o.shrq,sjzzjgdm:o.sjzzjgdm,sjzzjgmc:o.sjzzjgmc,ywjzdm:o.ywjzdm,...o}));z.value.push(...a),t.current+=1,t.total=e.total,e.total<t.current*t.size&&(r.value=!0)}else e.statusCode==403&&(U.value=e.statusCode)}).catch(e=>{R.value=!0,r.value=!0}).finally(()=>{p.value=!1,C.value=!1})}const A=async()=>{let e=null;for(var a in n.value)a=="biaoti"&&n.value[a]?e==null?e=" inspect.biaoti like '%"+n.value[a]+"%'":e=e+" and inspect.biaoti like '%"+n.value[a]+"%'":a=="neirong"&&n.value[a]?e==null?e=" neirong like '%"+n.value[a]+"%'":e=e+" and neirong like '%"+n.value[a]+"%'":a=="chizhileix"&&n.value[a]?e==null?e=" chizhileix = '"+n.value[a]+"'":e=e+" and chizhileix = '"+n.value[a]+"'":a=="shifoucaiyong"&&n.value[a]&&(n.value[a]=="部采州"?e==null?e=" shifoucaiyong = '部采' and caijidanwei like '653000%' ":e=e+" and shifoucaiyong = '部采' and caijidanwei like '653000%'":e==null?e=" shifoucaiyong = '"+n.value[a]+"'":e=e+" and shifoucaiyong = '"+n.value[a]+"'");const o={condition:e,num:10,start:0};e==null?(z.value=[],q()):await new Promise(P=>{ge(o).then(_=>{if(_.rows&&Array.isArray(_.rows)){z.value=_.rows,t.current+=1,t.total=_.total;debugger;_.total<t.current*t.size&&(r.value=!0)}}).catch(_=>{R.value=!0,r.value=!0}).finally(()=>{p.value=!1,C.value=!1})})};_e(()=>{q()});const S=d(!1),g=d(null),M=[{value:1,name:"查看详情"},{value:2,name:"核查反馈"},{value:3,name:"侦结报告"}],Y=e=>{switch(e.value){case 1:E.push({path:"/hcfk/check/check_detail",query:{bh:g.value.bianhao,shrq:g.value.shrq}});break;case 2:me(g.value.bianhao).then(a=>{a.length>0&&Array.isArray(a)?E.push({path:"/hcfk/check/check_feedback",query:{bh:g.value.bianhao}}):ye({message:"该条信息未查询到核查记录"})});break;case 3:E.push({name:"hcfk_zjbg",query:{id:g.value.bianhao,biaoti:g.value.biaoti}});break}S.value=!1};function H(e){g.value=e,S.value=!0,`${e.bianhao}`}return(e,a)=>{const o=u("van-search"),P=u("van-field"),_=u("van-button"),K=u("van-dropdown-item"),Q=u("van-dropdown-menu"),X=u("van-sticky"),ee=u("van-empty"),ae=u("van-skeleton"),b=u("van-tag"),le=u("van-space"),B=u("van-cell"),ne=u("van-cell-group"),te=u("van-divider"),oe=u("van-list"),se=u("van-pull-refresh"),ie=u("van-back-top"),ue=u("van-action-sheet");return c(),f("div",je,[s(X,null,{default:i(()=>[s(o,{modelValue:n.value.biaoti,"onUpdate:modelValue":a[0]||(a[0]=l=>n.value.biaoti=l),"show-action":"",label:"标题",placeholder:"请输入标题关键词",onSearch:F},{action:i(()=>[v("div",{onClick:W},"搜索")]),_:1},8,["modelValue"]),s(Q,{ref:"menuRef"},{default:i(()=>[s(K,{title:"筛选",ref_key:"itemRef",ref:D},{default:i(()=>[s(P,{modelValue:n.value.neirong,"onUpdate:modelValue":a[1]||(a[1]=l=>n.value.neirong=l),label:"内容",placeholder:"请输入搜索关键词"},null,8,["modelValue"]),s(L,{modelValue:n.value.chizhileix,"onUpdate:modelValue":a[2]||(a[2]=l=>n.value.chizhileix=l),options:T.value,label:"处置类型",placeholder:"请点击选择"},null,8,["modelValue","options"]),s(L,{modelValue:n.value.shifoucaiyong,"onUpdate:modelValue":a[3]||(a[3]=l=>n.value.shifoucaiyong=l),options:G.value,label:"采用类型",placeholder:"请点击选择"},null,8,["modelValue","options"]),v("div",Ve,[s(_,{type:"primary",block:"",onClick:$,style:{width:"49%"}},{default:i(()=>[h(" 重置 ")]),_:1}),s(_,{type:"primary",block:"",onClick:J,style:{width:"49%"}},{default:i(()=>[h(" 查询 ")]),_:1})])]),_:1},512)]),_:1},512)]),_:1}),U.value===403?(c(),f("div",Ce,[s(ee,{image:N(we),"image-size":"250"},null,8,["image"]),qe])):(c(),f("div",Ae,[s(se,{modelValue:p.value,"onUpdate:modelValue":a[5]||(a[5]=l=>p.value=l),onRefresh:Z,"success-text":"加载成功","loading-text":"加载中......"},{default:i(()=>[s(ae,{loading:C.value},null,8,["loading"]),C.value?m("",!0):(c(),f("div",Se,[R.value?(c(),f("div",Re,"加载失败，请重试")):(c(),f("div",Ee,[s(oe,{loading:p.value,"onUpdate:loading":a[4]||(a[4]=l=>p.value=l),finished:r.value,offset:50,"finished-text":"",onLoad:q},{default:i(()=>[(c(!0),f(he,null,fe(z.value,(l,ce)=>(c(),k(ne,{inset:"",key:ce,style:{"margin-top":"10px"}},{default:i(()=>[s(B,{"is-link":"",onClick:Te=>H(l)},{title:i(()=>[v("div",Ie,[v("span",null,[h(y(l.biaoti)+" ",1),["部采","市采","州采"].includes(l.shifoucaiyong)?(c(),k(b,{key:0,mark:"",plain:"",type:"primary",style:{"margin-left":"5px"}},{default:i(()=>[h(y(l.shifoucaiyong),1)]),_:2},1024)):m("",!0)])]),s(le,null,{default:i(()=>[l.db=="是"?(c(),k(b,{key:0,type:"success"},{default:i(()=>[h("已盯办 ")]),_:1})):m("",!0),l.chizhileix?(c(),k(b,{key:1,type:"primary"},{default:i(()=>[h(y(l.chizhileix),1)]),_:2},1024)):m("",!0),l.ywjzdm?(c(),k(b,{key:2,color:"#ffd01e"},{default:i(()=>[h(y(N(xe)(l.ywjzdm)),1)]),_:2},1024)):m("",!0),l.leixing?(c(),k(b,{key:3,type:"danger"},{default:i(()=>[h(y(l.leixing),1)]),_:2},1024)):m("",!0)]),_:2},1024)]),_:2},1032,["onClick"]),s(B,null,{default:i(()=>[v("div",Ue,[De,v("div",null,y(l.sjzzjgmc),1)]),v("div",Pe,[Be,v("div",null,y(l.sbzzjgmc),1)])]),_:2},1024)]),_:2},1024))),128)),r.value?(c(),f("div",Le,[s(te,null,{default:i(()=>[h("到底了")]),_:1})])):m("",!0)]),_:1},8,["loading","finished"])]))]))]),_:1},8,["modelValue"])])),s(ie),s(ue,{show:S.value,"onUpdate:show":a[6]||(a[6]=l=>S.value=l),actions:M,"cancel-text":"取消","close-on-click-action":"",onSelect:Y},null,8,["show"])])}}});const $e=be(Ne,[["__scopeId","data-v-c4e5d4f7"]]);export{$e as default};
