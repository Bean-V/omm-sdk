import{d as B,u as ne,f as i,o as v,g as T,h as l,z as n,j as y,Z as m,t as z,n as Y,_ as P,J as oe,r as f,T as le,e as se,C as ie,x as ue,ac as ce,l as p,W as re,F as de,D as ve,ad as _e,V as M,H as U,ae as fe,p as me,k as pe}from"./index-24b7b5a4.js";import{f as ge}from"./custom-f463eef0.js";import{u as he}from"./index-2afe3135.js";import{E as ye}from"./403-7bfaf254.js";const xe={class:"cell_custom_title"},ze=["innerHTML"],be=B({__name:"zl_list",props:{items:{type:Object,default:()=>{}}},setup(u){const A=ne(),o=u,x=()=>{A.push({path:"/hcfk/directive/directive_feedback",query:{xsbh:o.items.xsbh}})};return(E,j)=>{const c=i("van-tag"),r=i("van-space"),e=i("van-cell"),I=i("van-cell-group");return v(),T(I,{inset:"",style:{"margin-top":"10px"}},{default:l(()=>[n(e,{border:!1,"is-link":"",onClick:j[0]||(j[0]=g=>x())},{title:l(()=>[y("div",xe,[y("span",null,[m(z(u.items.biaoti),1),n(c,{mark:"",color:u.items.zhuangtai?"var(--van-orange-dark)":"var(--van-tag-default-color)",style:{"margin-left":"8px"}},{default:l(()=>[m(z(u.items.zhuangtai||u.items.zhuangtai=="true"?"完成":"未完成"),1)]),_:1},8,["color"])])]),n(r,null,{default:l(()=>[u.items.db=="是"?(v(),T(c,{key:0,type:"success"},{default:l(()=>[m("已盯办")]),_:1})):Y("",!0),n(c,{color:"#ffd01e"},{default:l(()=>[m(z(u.items.ywjzdm),1)]),_:1}),n(c,{type:"primary"},{default:l(()=>[m(z(u.items.jingjizhuangtai),1)]),_:1}),n(c,{type:"danger"},{default:l(()=>[m(z(u.items.leixing),1)]),_:1})]),_:1})]),label:l(()=>[y("div",{innerHTML:u.items.zhilingyaoq},null,8,ze)]),_:1}),n(e,{title:"完成时限",value:u.items.wanchengshixian},null,8,["value"])]),_:1})}}});const ke=P(be,[["__scopeId","data-v-ded7bb6d"]]),we=u=>(me("data-v-24b566cf"),u=u(),pe(),u),je={class:"page"},Ce={style:{padding:"5px 16px",display:"flex","justify-content":"space-around"}},Ve={key:0},De=we(()=>y("div",{style:{"text-align":"center",color:"var(--el-text-color-secondary)"}},"无权限访问！",-1)),Ae={key:1},Ie={key:0},Le={key:0,class:"error-message"},Se={key:1},Te={key:0,slot:"finished"},b=10,k=1,w=0,Ye=B({name:"hcfk_directive_list",__name:"directive_history",setup(u){const A=oe(),o=f({}),x=f(null),E=[{text:"一般",value:0},{text:"重要",value:1},{text:"紧急",value:2}],j=[{text:"否",value:"b"},{text:"是",value:"c"}];f(E[0].value),f(j[0].value);const c=f(!1),r=f(!1),e=le({size:b,current:k,total:w}),I=se(()=>e.size*e.current-e.size),g=f([]),C=f(!0),L=f(!1),N=async()=>{e.size=b,e.current=k,e.total=w,r.value=!1,g.value=[],o.value?D():V()};function V(){c.value=!0,o.value,_e({num:e.size,start:I.value}).then(t=>{if(r.value=!0,t.rows&&Array.isArray(t.rows)){const a=t.rows.map(s=>({id:s.id,xsbh:s.xsbh,biaoti:s.biaoti,xifajgdm:s.xifajgdm,xiafabum:s.xiafabum,xiafarensfz:s.xiafarensfz,xiafaren:s.xiafaren,wanchengshixian:M(s.wanchengshixian).format("YYYY-MM-DD HH:mm:ss"),xiafashijian:s.xiafashijian,zhuangtai:s.zhuangtai,jingjizhuangtai:s.jingjizhuangtai,ywjzdm:ge(s.ywjzdm),db:s.db,zhilingyaoq:he.removeTags(s.zhilingyaoq).substr(0,80)}));g.value.push(...a),e.current+=1,e.total=t.total,t.total<e.current*e.size&&(r.value=!0)}else t.statusCode==403?x.value=t.statusCode:U("未查询到数据")}).catch(t=>{L.value=!0,r.value=!0}).finally(()=>{c.value=!1,C.value=!1})}const q=()=>{o.value={}},$=t=>{e.size=b,e.current=k,e.total=w,r.value=!1,D()},G=()=>{e.size=b,e.current=k,e.total=w,r.value=!1,D()},R=f(null),Z=()=>{e.size=b,e.current=k,e.total=w,r.value=!1,R.value.toggle(),D()},D=async()=>{let t=null;for(var a in o.value)a=="biaoti"&&o.value[a]?t==null?t=" biaoti like '%"+o.value[a]+"%'":t=t+" and biaoti like '%"+o.value[a]+"%'":a=="zzjgmc"&&o.value[a]?t==null?t=" zzjgmc like '%"+o.value[a]+"%'":t=t+" and zzjgmc like '%"+o.value[a]+"%'":a=="sfwc"&&o.value[a]&&(t==null?t=" sfwc = '"+(o.value[a]?"是":"否")+"'":t=t+" and sfwc = '"+(o.value[a]?"是":"否")+"'");const s={condition:t,zzjgdm:A.userInfo.depcode,num:10,start:0};t==null?(g.value=[],V()):await new Promise(H=>{fe(s).then(_=>{if(_.rows&&Array.isArray(_.rows)){let S=_.rows.map(h=>(h.wanchengshixian=M(h.wanchengshixian).format("YYYY-MM-DD HH:mm:ss"),h));g.value=S,e.current+=1,e.total=_.total,_.total<e.current*e.size&&(r.value=!0)}else _.statusCode==403?x.value=_.statusCode:U("未查询到数据")}).catch(_=>{L.value=!0,r.value=!0}).finally(()=>{c.value=!1,C.value=!1})})};return ie(()=>{V()}),ue(()=>{console.log("页面注销")}),ce(()=>{console.log("页面注销")}),(t,a)=>{const s=i("van-search"),H=i("van-field"),_=i("van-switch"),S=i("van-cell"),h=i("van-button"),F=i("van-dropdown-item"),J=i("van-dropdown-menu"),O=i("van-sticky"),W=i("van-empty"),K=i("van-skeleton"),Q=i("van-divider"),X=i("van-list"),ee=i("van-pull-refresh"),te=i("van-back-top");return v(),p("div",je,[n(O,null,{default:l(()=>[n(s,{modelValue:o.value.biaoti,"onUpdate:modelValue":a[0]||(a[0]=d=>o.value.biaoti=d),"show-action":"",label:"标题",placeholder:"请输入标题关键词",onSearch:$},{action:l(()=>[y("div",{onClick:G},"搜索")]),_:1},8,["modelValue"]),n(J,{ref:"menuRef"},{default:l(()=>[n(F,{title:"筛选",ref_key:"itemRef",ref:R},{default:l(()=>[n(H,{modelValue:o.value.zzjgmc,"onUpdate:modelValue":a[1]||(a[1]=d=>o.value.zzjgmc=d),label:"接收单位",placeholder:"请输入接收单位"},null,8,["modelValue"]),n(S,{center:"",title:"是否采完成"},{"right-icon":l(()=>[n(_,{modelValue:o.value.sfwc,"onUpdate:modelValue":a[2]||(a[2]=d=>o.value.sfwc=d)},null,8,["modelValue"])]),_:1}),y("div",Ce,[n(h,{type:"primary",block:"",onClick:q,style:{width:"49%"}},{default:l(()=>[m(" 重置 ")]),_:1}),n(h,{type:"primary",block:"",onClick:Z,style:{width:"49%"}},{default:l(()=>[m(" 查询 ")]),_:1})])]),_:1},512)]),_:1},512)]),_:1}),x.value===403?(v(),p("div",Ve,[n(W,{image:re(ye),"image-size":"250"},null,8,["image"]),De])):(v(),p("div",Ae,[n(ee,{modelValue:c.value,"onUpdate:modelValue":a[4]||(a[4]=d=>c.value=d),onRefresh:N,"success-text":"加载成功","loading-text":"加载中......"},{default:l(()=>[n(K,{loading:C.value},null,8,["loading"]),C.value?Y("",!0):(v(),p("div",Ie,[L.value?(v(),p("div",Le,"加载失败，请重试")):(v(),p("div",Se,[n(X,{loading:c.value,"onUpdate:loading":a[3]||(a[3]=d=>c.value=d),finished:r.value,offset:50,"finished-text":"",onLoad:V},{default:l(()=>[(v(!0),p(de,null,ve(g.value,(d,ae)=>(v(),T(ke,{key:ae,items:d},null,8,["items"]))),128)),r.value?(v(),p("div",Te,[n(Q,null,{default:l(()=>[m("到底了")]),_:1})])):Y("",!0)]),_:1},8,["loading","finished"])]))]))]),_:1},8,["modelValue"])])),n(te)])}}});const Ue=P(Ye,[["__scopeId","data-v-24b566cf"]]);export{Ue as default};
