import{d as ne,a as ae,J as oe,r as y,e as le,C as ie,aq as se,f as u,o as _,l as f,z as e,h as l,j as m,F as ue,D as re,W as n,a0 as v,Z as S,Q as g,P as x,ar as de,ah as D,R as k,H as F,_ as ce}from"./index-24b7b5a4.js";import{m as q}from"./moment-53e63b5e.js";import{u as pe,a as he,b as me,c as _e}from"./useCheck-76650f95.js";import{o as fe}from"./custom-f463eef0.js";const ve={style:{flex:"1","margin-top":"30px"}},ge={style:{"margin-bottom":"26px",background:"#fff",padding:"15px","border-radius":"4px"}},xe=["innerHTML"],be={key:0},ye={key:1,class:"shDiv"},ke=ne({__name:"check_detail",setup(qe){const b=ae(),Y=oe(),j=y(null),T=[{value:"00",text:"情指"},{value:"01",text:"国保"},{value:"03",text:"治安"},{value:"05",text:"刑侦"},{value:"11",text:"网安"},{value:"12",text:"jz"},{value:"13",text:"监管"},{value:"17",text:"交警"},{value:"99",text:"其他"}],M=[{text:"涉黄",value:"Hangzhou"},{text:"涉毒",value:"Ningbo"},{text:"涉赌",value:"Wenzhou"}],A=[{text:"阿图什",value:"Hangzhou"},{text:"阿图什1",value:"Ningbo"},{text:"阿图什2",value:"Wenzhou"}],I=[{text:"网络",value:"Hangzhou"},{text:"网络1",value:"Ningbo"},{text:"网络2",value:"Wenzhou"}],{loading:U,run:G,data:N}=pe();function R(){G("cjleibie")}const{loading:B,data:o,run:O}=he(),r=b.query.bh,z=y(b.query.shrq),L=b.query.ShFlag;r&&O(r);function W(){g({title:"提示",message:"是否确认撤销该研判结果?"}).then(()=>{me().run({bianhao:r,shrq:q().format("YYYY-MM-DD HH:mm:ss"),leixing:""})}).catch(()=>{})}async function E(){if(z.value!==null)x({message:"该条信息已上会，无需上会"});else{if(!await de(r).then(async a=>{if(a.length>0&&Array.isArray(a))return a.filter(d=>d.bm=="县市")})){x({message:"该条信息未到达县市，不可执行【上会】操作"});return}const t=fe(Y.userInfo.depcode);g({title:"提示",message:"是否上会?"}).then(()=>{_e().run({beizhu:"",biaoti:"",caijidanwei:"",caijiren:"",caijishijian:"",laiyuan:"",leixing:o.value.leixing,mingzu:"",neirong:"",sfz:"",shejidiqu:"",ywjzdm:"",zhuyaorenyuan:"",zphone:"",bm:`${t}会`,xsbh:r,shrq:q().format("YYYY-MM-DD")}),z.value=q().format("YYYY-MM-DD")}).catch(()=>{})}}function J(){D(r).then(i=>{i.length>0&&Array.isArray(i)?x({message:"该条信息已有核查记录"}).then(()=>{k.push({path:"/hcfk/check/check_feedback",query:{bh:r}})}):k.push({path:"/hcfk/check/check_add",query:{bh:r}})})}function $(){D(r).then(i=>{i.length>0&&Array.isArray(i)?k.push({path:"/hcfk/check/check_feedback",query:{bh:r}}):x({message:"该条信息未查询到核查记录"})})}function P(){g({title:"提示",message:"是否保存?"}).then(()=>{F("已保存")}).catch(()=>{})}function Q(){g({title:"提示",message:"是否提交?"}).then(()=>{F("已提交")}).catch(()=>{})}le(()=>{const i=/\b(\d{15}|\d{18})\b/g,t=[];let a=0,d;const c=o.value.neirong.replace(/<[^>]+>/g,"");for(;(d=i.exec(c))!==null;)d.index>a&&t.push({text:c.slice(a,d.index),isId:!1}),t.push({text:d[0],isId:!0}),a=d.index+d[0].length;return a<c.length&&t.push({text:c.slice(a),isId:!1}),t}),ie(()=>{X()});const V=y(null);async function X(){se(r).then(i=>{if(i){var t=document.createElement("a");t.href="kzhcfk/gather/downloadFile/"+i.bianhao,t.textContent=i.name,setTimeout(()=>{V.value.appendChild(t)},1e3)}})}return(i,t)=>{const a=u("van-skeleton-paragraph"),d=u("FieldAndSelect"),c=u("van-cell-group"),p=u("van-cell"),w=u("van-field"),Z=u("van-form"),H=u("van-radio"),K=u("van-radio-group"),h=u("van-action-bar-icon"),ee=u("van-action-bar-button"),C=u("van-action-bar"),te=u("van-skeleton");return _(),f("div",null,[e(te,{loading:n(B),animate:!1},{template:l(()=>[m("div",ve,[m("div",ge,[e(a,{"row-width":"60%"}),e(a),e(a),e(a)]),(_(),f(ue,null,re(3,s=>m("div",{key:s,style:{"margin-bottom":"20px",background:"#fff",padding:"15px","border-radius":"4px"}},[e(a),e(a),e(a)])),64))])]),default:l(()=>[e(Z,null,{default:l(()=>[e(c,{inset:"",title:"基本信息"},{default:l(()=>[e(d,{modelValue:n(o).biaoti,"onUpdate:modelValue":t[0]||(t[0]=s=>n(o).biaoti=s),label:"标题",placeholder:"请输入",required:"",center:"",rules:[{required:!0,message:"",trigger:"onBlur"}],btntext:"预设",loading:n(U),options:n(N),onShowSelector:R},null,8,["modelValue","loading","options"]),e(v,{modelValue:n(o).ywjzdm,"onUpdate:modelValue":t[1]||(t[1]=s=>n(o).ywjzdm=s),options:T,label:"业务警种",required:"",placeholder:"请点击选择"},null,8,["modelValue"]),e(v,{modelValue:n(o).leixing,"onUpdate:modelValue":t[2]||(t[2]=s=>n(o).leixing=s),options:M,label:"采集类型",required:"",placeholder:"请点击选择"},null,8,["modelValue"]),e(v,{modelValue:n(o).shejidiqu,"onUpdate:modelValue":t[3]||(t[3]=s=>n(o).shejidiqu=s),options:A,label:"涉及地区",required:"",placeholder:"请点击选择"},null,8,["modelValue"]),e(v,{modelValue:n(o).laiyuan,"onUpdate:modelValue":t[4]||(t[4]=s=>n(o).laiyuan=s),options:I,label:"信息来源",required:"",placeholder:"请点击选择"},null,8,["modelValue"])]),_:1}),e(c,{inset:"",title:"信息详情"},{default:l(()=>[e(p,{title:"采集内容"},{label:l(()=>[m("div",{innerHTML:n(o).neirong,style:{color:"var(--van-cell-text-color)","font-size":"var(--van-cell-font-size)"}},null,8,xe)]),_:1})]),_:1}),e(c,{inset:"",style:{"margin-top":"20px"}},{default:l(()=>[e(w,{name:"uploader",label:"附件","label-align":"top"},{input:l(()=>[m("div",{ref_key:"uploadfile",ref:V},null,512)]),_:1})]),_:1})]),_:1}),e(c,{inset:"",style:{"margin-top":"20px"}},{default:l(()=>[e(p,{title:"采集人",value:n(o).caijiren},null,8,["value"]),e(p,{title:"采集人手机号",value:n(o).phone},null,8,["value"]),e(p,{class:"lql-cell",title:"采集单位",value:n(o).caijidanwei},null,8,["value"]),e(p,{title:"采集时间",value:n(o).caijishijian},null,8,["value"])]),_:1}),n(L)?(_(),f("div",ye,[e(C,null,{default:l(()=>[e(h,{icon:"newspaper-o",text:"核查记录",onClick:$})]),_:1})])):(_(),f("div",be,[e(c,{inset:"",title:"审核意见",style:{"margin-bottom":"60px"}},{default:l(()=>[e(w,{name:"radio",label:"是否采用",required:""},{input:l(()=>[e(K,{modelValue:j.value,"onUpdate:modelValue":t[5]||(t[5]=s=>j.value=s),direction:"horizontal"},{default:l(()=>[e(H,{name:"1"},{default:l(()=>[S("采用")]),_:1}),e(H,{name:"2"},{default:l(()=>[S("不采用")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(C,null,{default:l(()=>[e(h,{icon:"revoke",text:"撤销",onClick:W}),e(h,{icon:"friends-o",text:"上会",onClick:E}),e(h,{icon:"records",text:"核查",onClick:J}),e(h,{icon:"invitation",text:"保存",onClick:P}),e(ee,{type:"primary",text:"提交",onClick:Q})]),_:1})]))]),_:1},8,["loading"])])}}});const He=ce(ke,[["__scopeId","data-v-1e81c951"]]);export{He as default};
