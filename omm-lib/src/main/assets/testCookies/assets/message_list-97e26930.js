import{d as D,r as d,T as L,e as N,C as j,f as u,o as s,l as i,z as _,h as c,F as w,D as B,n as P,U as T,V as U,g as G,j as m,t as g}from"./index-24b7b5a4.js";const M={class:"page"},R={key:0},S={key:0,class:"error-message"},F={key:1},h=10,k=1,y=0,O=D({__name:"message_list",setup(H){const n=d(!1),l=d(!1),e=L({size:h,current:k,total:y}),z=N(()=>e.size*e.current-e.size),v=d([]),f=d(!0),C=async()=>{e.size=h,e.current=k,e.total=y,l.value=!1,v.value=[],p()};function p(){n.value=!0,T({num:e.size,start:z.value}).then(t=>{if(l.value=!0,t.rows&&Array.isArray(t.rows)){const o=t.rows.map(r=>(r.fabushijian=U(r.fabushijian).format("MM-DD HH:mm"),r));v.value.push(...o),e.current+=1,e.total=t.total,t.total<e.current*e.size&&(l.value=!0)}}).catch(t=>{error.value=!0,l.value=!0}).finally(()=>{n.value=!1,f.value=!1})}return j(()=>{p()}),(t,o)=>{const r=u("van-skeleton"),V=u("van-cell"),x=u("van-cell-group"),A=u("van-list"),E=u("van-pull-refresh");return s(),i("div",M,[_(E,{modelValue:n.value,"onUpdate:modelValue":o[1]||(o[1]=a=>n.value=a),onRefresh:C,"success-text":"加载成功","loading-text":"加载中......"},{default:c(()=>[_(r,{loading:f.value},null,8,["loading"]),f.value?P("",!0):(s(),i("div",R,[t.error?(s(),i("div",S,"加载失败，请重试")):(s(),i("div",F,[_(A,{loading:n.value,"onUpdate:loading":o[0]||(o[0]=a=>n.value=a),finished:l.value,offset:50,"finished-text":"",onLoad:p},{default:c(()=>[(s(!0),i(w,null,B(v.value,(a,b)=>(s(),G(x,{inset:"",key:b,style:{"margin-top":"10px"}},{default:c(()=>[_(V,{title:a.biaoti},{label:c(()=>[m("span",null,g(a.neirong),1)]),"right-icon":c(()=>[m("span",null,g(a.fabushijian),1)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:1},8,["loading","finished"])]))]))]),_:1},8,["modelValue"])])}}});export{O as default};
