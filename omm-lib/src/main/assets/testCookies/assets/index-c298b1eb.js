import{d as D,a as U,J as S,r as u,f as o,o as p,l as f,z as s,h as r,j as c,F,D as N,O as q,P as J,Q as P,R,S as $,g as A}from"./index-24b7b5a4.js";const E={class:"page"},I={key:0},L={style:{width:"100vw"}},Q={key:1},T=c("div",{class:"searchBJ"},null,-1),G=c("div",{class:"searchTitle"},"人 员 检 索",-1),H={class:"searchClass"},W=D({__name:"index",setup(K){const V=U(),w=S(),y=V.query.id,t=u("653022200301260024"),b=u(""),d=u(!1),_=u([]);u([]);const i=u([]),h=u([]),k=()=>{q({sfzhm:y||t.value}).then(a=>{a.length>0?(_.value=[],i.value=[],h.value=[],a.filter(e=>{_.value.push({text:e.description,value:e.tablename,sjlx:e.sjlx})})):J({message:"未查询到数据"})})},z=({selectedOptions:a})=>{if(a[0].sjlx==="授权")P({title:"无权限",message:"未授权，是否申请授权"}).then(()=>{console.log(a[0]),R.push({path:"/hcfk/search/search_addCheck",query:{tableName:a[0].text,tableValue:a[0].value,sfzh:t.value}})}).catch(()=>{});else{i.value=[],h.value=[],d.value=!1,b.value=a[0].text;const e={sfzhm:t.value,tname:a[0].value+":"+a[0].sjlx,usfzhm:w.userInfo.idcard};$(e).then(m=>{let v={};m.columns.filter((n,x)=>{i.value.push({prop:n.feildme,label:n.description})}),m.data.filter((n,x)=>{v={},n.filter((g,C)=>{v[i.value[C].prop]=g}),h.value.push(v)})})}};return(a,e)=>{const m=o("van-search"),v=o("van-sticky"),n=o("van-field"),x=o("van-picker"),g=o("van-popup"),C=o("el-table-column"),j=o("el-table"),B=o("van-cell-group");return p(),f("div",E,[_.value.length>0?(p(),f("div",I,[s(v,null,{default:r(()=>[s(m,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value=l),"show-action":"",label:"地址",shape:"round",placeholder:"请输入搜索关键词",onSearch:k},{action:r(()=>[c("div",{onClick:k},"搜索")]),_:1},8,["modelValue"])]),_:1}),s(n,{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=l=>b.value=l),"is-link":"",readonly:"",label:"类型",placeholder:"选择类型",onClick:e[2]||(e[2]=l=>d.value=!0)},null,8,["modelValue"]),s(g,{show:d.value,"onUpdate:show":e[4]||(e[4]=l=>d.value=l),round:"",position:"bottom"},{default:r(()=>[s(x,{columns:_.value,onCancel:e[3]||(e[3]=l=>d.value=!1),onConfirm:z},null,8,["columns"])]),_:1},8,["show"]),c("div",L,[s(j,{data:h.value,border:"",stripe:"",fit:"",height:"600",style:{width:"100%"}},{default:r(()=>[(p(!0),f(F,null,N(i.value,l=>(p(),A(C,{prop:l.prop,label:l.label,width:"200"},null,8,["prop","label"]))),256))]),_:1},8,["data"])])])):(p(),f("div",Q,[T,G,c("div",H,[s(B,{class:"searchChild",inset:""},{default:r(()=>[s(n,{modelValue:t.value,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value=l),center:"",clearable:"",placeholder:"请输入身份证号或手机号"},{button:r(()=>[c("div",{class:"searchBtn",onClick:k},"搜索")]),_:1},8,["modelValue"])]),_:1})])]))])}}});export{W as default};
