import{d as B,u as Z,f as i,o as r,g as E,h as u,z as o,j,t as b,Z as x,n as I,_ as P,r as _,T as O,e as W,C as $,x as J,ac as K,l as m,W as Q,F as X,D as ee,ad as te,V as ae,H as S,ae as ne,p as oe,k as se}from"./index-24b7b5a4.js";import{f as le}from"./custom-f463eef0.js";import{E as ie}from"./403-7bfaf254.js";const ue=B({__name:"zlfk_list",props:{items:{type:Object,default:()=>{}}},setup(l){const c=Z(),g=l,V=()=>{c.push({path:"/hcfk/directiveFeedback/dfb_detail",query:{xsbh:g.items.xsbh}})};return(q,d)=>{const s=i("van-tag"),e=i("van-space"),A=i("van-text-ellipsis"),f=i("van-cell"),h=i("van-cell-group");return r(),E(h,{inset:"",style:{"margin-top":"10px"}},{default:u(()=>[o(f,{border:!1,"is-link":""},{title:u(()=>[j("div",{class:"cell_custom_title",onClick:d[0]||(d[0]=y=>V())},[j("span",null,b(l.items.biaoti),1)]),o(e,null,{default:u(()=>[l.items.db=="是"?(r(),E(s,{key:0,type:"success"},{default:u(()=>[x("已盯办")]),_:1})):I("",!0),o(s,{color:"#ffd01e"},{default:u(()=>[x(b(l.items.ywjzdm),1)]),_:1}),o(s,{type:"primary"},{default:u(()=>[x(b(l.items.jingjizhuangtai),1)]),_:1}),o(s,{type:"danger"},{default:u(()=>[x(b(l.items.leixing),1)]),_:1})]),_:1})]),label:u(()=>[o(A,{content:l.items.zhilingyaoq,rows:"2","expand-text":"展开","collapse-text":"收起",dots:"..."},null,8,["content"])]),_:1}),o(f,{title:"完成时限",value:l.items.wanchengshixian},null,8,["value"])]),_:1})}}});const ce=P(ue,[["__scopeId","data-v-74ce30fb"]]),re=l=>(oe("data-v-25045a0c"),l=l(),se(),l),de={class:"page"},ve={key:0},_e=re(()=>j("div",{style:{"text-align":"center",color:"var(--el-text-color-secondary)"}},"无权限访问！",-1)),fe={key:1},me={key:0},pe={key:0,class:"error-message"},he={key:1},ge={key:0,slot:"finished"},z=10,w=1,C=0,xe=B({name:"hcfk_directive_list",__name:"dfb_list",setup(l){const c=_({}),g=_(null),V=[{text:"一般",value:0},{text:"重要",value:1},{text:"紧急",value:2}],q=[{text:"否",value:"b"},{text:"是",value:"c"}];_(V[0].value),_(q[0].value);const d=_(!1),s=_(!1),e=O({size:z,current:w,total:C}),A=W(()=>e.size*e.current-e.size),f=_([]),h=_(!0),y=_(!1),T=async()=>{e.size=z,e.current=w,e.total=C,s.value=!1,f.value=[],c.value?D():k()};function k(){d.value=!0,te({num:e.size,start:A.value}).then(t=>{if(s.value=!0,t.rows&&Array.isArray(t.rows)){const n=t.rows.map(a=>({id:a.id,xsbh:a.xsbh,biaoti:a.biaoti,xifajgdm:a.xifajgdm,xiafabum:a.xiafabum,xiafarensfz:a.xiafarensfz,xiafaren:a.xiafaren,wanchengshixian:ae(a.wanchengshixian).format("YYYY-MM-DD HH:mm:ss"),xiafashijian:a.xiafashijian,zhuangtai:a.zhuangtai,jingjizhuangtai:a.jingjizhuangtai,ywjzdm:le(a.ywjzdm),db:a.db,zhilingyaoq:a.zhilingyaoq}));f.value.push(...n),e.current+=1,e.total=t.total,t.total<e.current*e.size&&(s.value=!0)}else t.statusCode==403?g.value=t.statusCode:S("未查询到数据")}).catch(t=>{y.value=!0}).finally(()=>{d.value=!1,h.value=!1})}const N=t=>{e.size=z,e.current=w,e.total=C,s.value=!1,D()},Y=()=>{e.size=z,e.current=w,e.total=C,s.value=!1,D()},D=async()=>{let t=null;for(var n in c.value)n=="biaoti"&&c.value[n]?t==null?t=" biaoti like '%"+c.value[n]+"%'":t=t+" and biaoti like '%"+c.value[n]+"%'":n=="zhilingyaoq"&&c.value[n]&&(t==null?t=" zhilingyaoq like '%"+c.value[n]+"%'":t=t+" and zhilingyaoq like '%"+c.value[n]+"%'");const a={condition:t,num:10,start:0};t==null?(f.value=[],k()):await new Promise(L=>{ne(a).then(v=>{v.rows&&Array.isArray(v.rows)?(f.value=v.rows,e.current+=1,e.total=v.total,v.total<e.current*e.size&&(s.value=!0)):v.statusCode==403?g.value=v.statusCode:S("未查询到数据")}).catch(v=>{y.value=!0,s.value=!0}).finally(()=>{d.value=!1,h.value=!1})})};return $(()=>{k()}),J(()=>{console.log("页面注销")}),K(()=>{console.log("页面注销")}),(t,n)=>{const a=i("van-search"),L=i("van-sticky"),v=i("van-empty"),R=i("van-skeleton"),U=i("van-divider"),F=i("van-list"),G=i("van-pull-refresh"),H=i("van-back-top");return r(),m("div",de,[o(L,null,{default:u(()=>[o(a,{modelValue:c.value.biaoti,"onUpdate:modelValue":n[0]||(n[0]=p=>c.value.biaoti=p),"show-action":"",label:"标题",placeholder:"请输入标题关键词",onSearch:N},{action:u(()=>[j("div",{onClick:Y},"搜索")]),_:1},8,["modelValue"])]),_:1}),g.value===403?(r(),m("div",ve,[o(v,{image:Q(ie),"image-size":"250"},null,8,["image"]),_e])):(r(),m("div",fe,[o(G,{modelValue:d.value,"onUpdate:modelValue":n[2]||(n[2]=p=>d.value=p),onRefresh:T,"success-text":"加载成功","loading-text":"加载中......"},{default:u(()=>[o(R,{loading:h.value},null,8,["loading"]),h.value?I("",!0):(r(),m("div",me,[y.value?(r(),m("div",pe,"加载失败，请重试")):(r(),m("div",he,[o(F,{loading:d.value,"onUpdate:loading":n[1]||(n[1]=p=>d.value=p),finished:s.value,offset:50,"finished-text":"",onLoad:k},{default:u(()=>[(r(!0),m(X,null,ee(f.value,(p,M)=>(r(),E(ce,{key:M,items:p},null,8,["items"]))),128)),s.value?(r(),m("div",ge,[o(U,null,{default:u(()=>[x("到底了")]),_:1})])):I("",!0)]),_:1},8,["loading","finished"])]))]))]),_:1},8,["modelValue"])])),o(H)])}}});const ze=P(xe,[["__scopeId","data-v-25045a0c"]]);export{ze as default};
