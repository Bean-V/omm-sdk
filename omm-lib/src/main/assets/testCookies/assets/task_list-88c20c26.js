import{d as ae,r,J as oe,T as ne,e as le,C as se,x as ce,ac as ie,f as s,o as _,l as v,z as l,h as i,j as u,Z as j,W as ue,F as de,D as re,n as A,aT as _e,V as ve,H as fe,aU as pe,p as me,k as he,g as ge,t as h,R as ye,_ as ke}from"./index-24b7b5a4.js";import{E as ze}from"./403-7bfaf254.js";const C=z=>(me("data-v-51171d7c"),z=z(),he(),z),xe={class:"page"},we={style:{padding:"5px 16px",display:"flex","justify-content":"space-around"}},be={key:0},je=C(()=>u("div",{style:{"text-align":"center",color:"var(--el-text-color-secondary)"}},"无权限访问！",-1)),Ce={key:1},Ve={key:0},Ae={key:0,class:"error-message"},De={key:1},Se={key:0,class:"stamp"},Ee={class:"custom-title"},Re={class:"cell_custom_title"},Ue=C(()=>u("span",null,"下发单位",-1)),Ie={class:"cell_custom_title"},Te=C(()=>u("span",null,"接收单位",-1)),Be={class:"cell_custom_title"},Pe=C(()=>u("span",null,"完成时限",-1)),Le={key:0,slot:"finished"},g=10,y=1,k=0,Ne=ae({name:"hcfk_check_list",__name:"task_list",setup(z){const o=r({}),D=r(null),S=oe(),T=[{text:"一般",value:0},{text:"重要",value:1},{text:"紧急",value:2}],B=[{text:"否",value:"b"},{text:"是",value:"c"}];r(T[0].value),r(B[0].value);const p=r(!1),d=r(!1),a=ne({size:g,current:y,total:k}),P=le(()=>a.size*a.current-a.size),m=r([]),x=r(!0),V=r(!1),L=async()=>{a.size=g,a.current=y,a.total=k,d.value=!1,m.value=[],o.value?b():w()};function w(){p.value=!0,_e({num:a.size,start:P.value,zzjgdm:S.userInfo.depcode}).then(e=>{if(d.value=!0,e.rows&&Array.isArray(e.rows)){const t=e.rows.map(c=>({id:c.id,bianhao:c.bianhao,biaoti:c.biaoti,sfwc:c.sfwc,sjy:c.sjy,wanchengshixian:ve(c.wanchengshixian).format("YYYY-MM-DD HH:mm:ss"),xfbm:c.xfbm,xfbmdm:c.xfbmdm,xiafatime:c.xiafatime,zzjgdm:c.zzjgdm,zzjgmc:c.zzjgmc}));m.value.push(...t),a.current+=1,a.total=e.total,e.total<a.current*a.size&&(d.value=!0)}else e.statusCode==403?D.value=e.statusCode:fe("未查询到数据")}).catch(e=>{V.value=!0,d.value=!0}).finally(()=>{p.value=!1,x.value=!1})}const N=()=>{o.value={}},G=e=>{a.size=g,a.current=y,a.total=k,d.value=!1,b()},H=()=>{a.size=g,a.current=y,a.total=k,d.value=!1,b()},E=r(null),Y=()=>{a.size=g,a.current=y,a.total=k,d.value=!1,E.value.toggle(),b()},b=async()=>{let e=null;for(var t in o.value)t=="biaoti"&&o.value[t]?e==null?e=" biaoti like '%"+o.value[t]+"%'":e=e+" and biaoti like '%"+o.value[t]+"%'":t=="zzjgmc"&&o.value[t]?e==null?e=" zzjgmc like '%"+o.value[t]+"%'":e=e+" and zzjgmc like '%"+o.value[t]+"%'":t=="sfwc"&&o.value[t]&&(e==null?e=" sfwc = '"+(o.value[t]?"是":"否")+"'":e=e+" and sfwc = '"+(o.value[t]?"是":"否")+"'");const c={condition:e,zzjgdm:S.userInfo.depcode,num:10,start:0};e==null?(m.value=[],w()):await new Promise(R=>{pe(c).then(f=>{f.rows&&Array.isArray(f.rows)&&(m.value=f.rows,a.current+=1,a.total=f.total,f.total<a.current*a.size&&(d.value=!0))}).catch(f=>{V.value=!0,d.value=!0}).finally(()=>{p.value=!1,x.value=!1})})};se(()=>{w()}),ce(()=>{console.log("页面注销")}),ie(()=>{console.log("页面注销")});const M=e=>{ye.push({path:"/hcfk/check/check_feedback",query:{bh:e}})};return(e,t)=>{const c=s("van-search"),R=s("van-field"),f=s("van-switch"),U=s("van-cell"),I=s("van-button"),O=s("van-dropdown-item"),F=s("van-dropdown-menu"),Z=s("van-sticky"),q=s("van-empty"),J=s("van-skeleton"),W=s("van-tag"),$=s("van-cell-group"),K=s("van-divider"),Q=s("van-list"),X=s("van-pull-refresh"),ee=s("van-back-top");return _(),v("div",xe,[l(Z,null,{default:i(()=>[l(c,{modelValue:o.value.biaoti,"onUpdate:modelValue":t[0]||(t[0]=n=>o.value.biaoti=n),"show-action":"",label:"标题",placeholder:"请输入标题关键词",onSearch:G},{action:i(()=>[u("div",{onClick:H},"搜索")]),_:1},8,["modelValue"]),l(F,{ref:"menuRef"},{default:i(()=>[l(O,{title:"筛选",ref_key:"itemRef",ref:E},{default:i(()=>[l(R,{modelValue:o.value.zzjgmc,"onUpdate:modelValue":t[1]||(t[1]=n=>o.value.zzjgmc=n),label:"接收单位",placeholder:"请输入接收单位"},null,8,["modelValue"]),l(U,{center:"",title:"是否采完成"},{"right-icon":i(()=>[l(f,{modelValue:o.value.sfwc,"onUpdate:modelValue":t[2]||(t[2]=n=>o.value.sfwc=n)},null,8,["modelValue"])]),_:1}),u("div",we,[l(I,{type:"primary",block:"",onClick:N,style:{width:"49%"}},{default:i(()=>[j(" 重置 ")]),_:1}),l(I,{type:"primary",block:"",onClick:Y,style:{width:"49%"}},{default:i(()=>[j(" 查询 ")]),_:1})])]),_:1},512)]),_:1},512)]),_:1}),D.value===403?(_(),v("div",be,[l(q,{image:ue(ze),"image-size":"250"},null,8,["image"]),je])):(_(),v("div",Ce,[l(X,{modelValue:p.value,"onUpdate:modelValue":t[4]||(t[4]=n=>p.value=n),onRefresh:L,"success-text":"加载成功","loading-text":"加载中......"},{default:i(()=>[l(J,{loading:x.value},null,8,["loading"]),x.value?A("",!0):(_(),v("div",Ve,[V.value?(_(),v("div",Ae,"加载失败，请重试")):(_(),v("div",De,[l(Q,{loading:p.value,"onUpdate:loading":t[3]||(t[3]=n=>p.value=n),finished:d.value,offset:50,"finished-text":"",onLoad:w},{default:i(()=>[(_(!0),v(de,null,re(m.value,(n,te)=>(_(),ge($,{key:te},{default:i(()=>[n.sfwc=="是"?(_(),v("div",Se)):A("",!0),l(U,{"is-link":"",style:{"margin-top":"10px"},onClick:Ge=>M(n.bianhao)},{title:i(()=>[l(W,{type:n.sjy=="研判"?"primary":"success"},{default:i(()=>[j(h(n.sjy),1)]),_:2},1032,["type"]),u("span",Ee,h(n.biaoti),1)]),label:i(()=>[u("div",Re,[Ue,u("div",null,h(n.xfbm),1)]),u("div",Ie,[Te,u("div",null,h(n.zzjgmc),1)]),u("div",Be,[Pe,u("div",null,h(n.wanchengshixian),1)])]),_:2},1032,["onClick"])]),_:2},1024))),128)),d.value?(_(),v("div",Le,[l(K,null,{default:i(()=>[j("到底了")]),_:1})])):A("",!0)]),_:1},8,["loading","finished"])]))]))]),_:1},8,["modelValue"])])),l(ee)])}}});const Me=ke(Ne,[["__scopeId","data-v-51171d7c"]]);export{Me as default};
