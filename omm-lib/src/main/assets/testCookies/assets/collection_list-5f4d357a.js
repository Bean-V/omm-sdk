import{d as N,u as se,r as v,a8 as ie,f as u,o as m,l as y,z as o,h as c,j as C,Z as b,t as w,F as Y,Q as q,a9 as ue,a3 as B,a5 as H,P as ce,a6 as re,a7 as de,_ as O,T as ve,e as fe,C as _e,W as pe,D as me,n as I,aa as he,V as $,$ as ge,ab as ye,p as be,k as xe,g as ze}from"./index-24b7b5a4.js";import{u as G}from"./index-2afe3135.js";import{E as ke}from"./403-7bfaf254.js";const je={class:"cell_custom_title"},we=["innerHTML"],Ce=N({__name:"cj_list",props:{items:{type:Object,default:()=>{}}},setup(r){const n=se(),x=r,z=v(!1),A=v([{text:"查看信息",value:"1"},{text:"修改信息",value:"2"},{text:"删除信息",value:"3"},{text:"上报信息",value:"4"}]);ie(()=>{A.value.map(s=>{if(x.items.sfsb&&(s.value=="2"||s.value=="3"||s.value=="4"))return s.disabled=!0,s;if(x.items.sfsb==!1)return s.disabled=!1,s})});const L=()=>{const s={...x.items};n.push({path:"/hcfk/collection/collection_detail",query:s})},h=({selectedOptions:s})=>{const e=s[0].text,i={...x.items};if(z.value=!1,e=="查看信息")n.push({path:"/hcfk/collection/collection_detail",query:i});else if(e=="修改信息")console.log("params",i),n.push({path:"/hcfk/collection/collection_add",query:i});else if(e=="删除信息")q({title:"提示",message:"是否删除该条信息？删除后将无法恢复！"}).then(()=>{ue(i.xsbh).then(f=>{console.log(f),f?H("删除失败"):B("删除成功")})}).catch(()=>{});else if(e=="上报信息")if(i.zzjgdm===653e9){ce({message:"您无需上报"});return}else q({title:"提示",message:"是否上报"}).then(()=>{re(i.xsbh).then(f=>{if(f)H("上报失败");else{const g={bianhao:i.xsbh,biaoti:i.biaoti,ywjzdm:i.ywjzdm,sbzzjgdm:i.zzjgdm,sfzhmsbr:i.caijiren,sbzzjgmc:i.caijidanwei,dh:""};de(g).then(k=>{console.log("上报：",k),B("上报成功"),n.back()})}})}).catch(()=>{})};return(s,e)=>{const i=u("van-tag"),f=u("van-space"),g=u("van-cell"),k=u("van-cell-group"),P=u("van-picker"),j=u("van-popup");return m(),y(Y,null,[o(k,{inset:"",style:{"margin-top":"10px"}},{default:c(()=>[o(g,{border:!1,"is-link":"",onClick:e[0]||(e[0]=V=>r.items.sfsb?L():z.value=!0)},{title:c(()=>[C("div",je,[C("span",null,[b(w(r.items.biaoti),1),o(i,{mark:"",color:r.items.sfsb?"var(--van-orange-dark)":"var(--van-tag-default-color)",style:{"margin-left":"8px"}},{default:c(()=>[b(w(r.items.sfsb?"已提交":"未提交"),1)]),_:1},8,["color"])])]),o(f,null,{default:c(()=>[o(i,{color:"#ffd01e"},{default:c(()=>[b(w(r.items.ywjzdm),1)]),_:1}),o(i,{type:"primary"},{default:c(()=>[b(w(r.items.shejidiqu),1)]),_:1}),o(i,{type:"success"},{default:c(()=>[b(w(r.items.laiyuan),1)]),_:1}),o(i,{type:"danger"},{default:c(()=>[b(w(r.items.leixing),1)]),_:1})]),_:1})]),label:c(()=>[C("div",{innerHTML:r.items.neirong},null,8,we)]),_:1}),o(g,{title:"采集时间",value:r.items.caijishijian},null,8,["value"])]),_:1}),o(j,{show:z.value,"onUpdate:show":e[2]||(e[2]=V=>z.value=V),round:"",position:"bottom"},{default:c(()=>[o(P,{columns:A.value,onCancel:e[1]||(e[1]=V=>z.value=!1),onConfirm:h},null,8,["columns"])]),_:1},8,["show"])],64)}}});const Ve=O(Ce,[["__scopeId","data-v-6634ed59"]]),De=r=>(be("data-v-958bd93e"),r=r(),xe(),r),Se={style:{padding:"5px 16px",display:"flex","justify-content":"space-around"}},Te={key:0},Ae=De(()=>C("div",{style:{"text-align":"center",color:"var(--el-text-color-secondary)"}},"无权限访问！",-1)),Le={key:1},Ue={key:0},Ee={key:0,class:"error-message"},Pe={key:1},Re={key:0,slot:"finished"},D=2,S=1,T=0,Ye=N({name:"hcfk_collection_list",__name:"collection_list",setup(r){const n=v({}),x=v(null),z=v([]),A=v([{text:"工作掌握",value:"工作掌握"},{text:"密悉掌握",value:"密悉掌握"},{text:"人力情报",value:"人力情报"},{text:"技术情报",value:"技术情报"},{text:"群众举报",value:"群众举报"},{text:"末梢信息",value:"末梢信息"},{text:"审讯深挖",value:"审讯深挖"},{text:"异地推送",value:"异地推送"},{text:"上级通报",value:"上级通报"}]),L=v({"00":"情指","01":"国保","03":"治安","05":"刑侦",11:"网安",12:"jz",13:"监管",17:"交警",99:"其他"}),h=v(!1),s=v(!1),e=ve({size:D,current:S,total:T}),i=fe(()=>e.size*e.current-e.size),f=v([]),g=v(!0),k=v(!1),P=async()=>{e.size=D,e.current=S,e.total=T,s.value=!1,f.value=[],n.value?U():j()};function j(){h.value=!0,he({num:e.size,start:i.value}).then(t=>{if(s.value=!0,t.rows&&Array.isArray(t.rows)){const a=t.rows.map(l=>({biaoti:l.biaoti,caijidanwei:l.caijidanwei,caijiren:l.caijiren,caijishijian:$(l.caijishijian).format("YYYY-MM-DD HH:mm:ss"),dh:l.dh,fenlei:l.fenlei,hechadanweidm:l.hechadanweidm,laiyuan:l.laiyuan,leixing:l.leixing,mingzu:l.mingzu,neirong:G.removeTags(l.neirong).substr(0,80),neirong1:l.neirong,sfsb:l.sfsb,sfz:l.sfz,sfzhm:l.sfzhm,shejidiqu:l.shejidiqu,xsbh:l.xsbh,ywjzdm:L.value[l.ywjzdm],zhuyaorenyuan:l.zhuyaorenyuan,zphone:l.zphone,zzjgdm:l.zzjgdm}));f.value.push(...a),e.current+=1,e.total=t.total,t.total<e.current*e.size&&(s.value=!0)}else t.statusCode==403&&(x.value=t.statusCode)}).catch(t=>{k.value=!0,s.value=!0}).finally(()=>{h.value=!1,g.value=!1})}const V=()=>{n.value={}},F=t=>{e.size=D,e.current=S,e.total=T,s.value=!1,U()},Z=()=>{e.size=D,e.current=S,e.total=T,s.value=!1,U()},M=v(null),Q=()=>{e.size=D,e.current=S,e.total=T,s.value=!1,M.value.toggle(),U()};function W(){ge({leibie:"cjleibie"}).then(t=>{const a=t[0].map((l,R)=>(l={text:l,value:l},l));z.value.push(a)})}const U=async()=>{let t=null;for(var a in n.value)a=="biaoti"&&n.value[a]?t==null?t="biaoti like '%"+n.value[a]+"%'":t=t+" and biaoti like '%"+n.value[a]+"%'":a=="neirong"&&n.value[a]?t==null?t="neirong like '%"+n.value[a]+"%'":t=t+" and neirong like '%"+n.value[a]+"%'":a=="leixing"&&n.value[a]?t==null?t="leixing = '"+n.value[a]+"'":t=t+" and leixing = '"+n.value[a]+"'":a=="laiyuan"&&n.value[a]&&(t==null?t="laiyuan = '"+n.value[a]+"'":t=t+" and laiyuan = '"+n.value[a]+"'");const l={condition:t,num:10,start:0};t==null?(f.value=[],j()):await new Promise(R=>{ye(l).then(_=>{if(_.rows&&Array.isArray(_.rows)){let E=_.rows.map(p=>(p.neirong1=p.neirong,p.neirong=G.removeTags(p.neirong).substr(0,80),p.ywjzdm=L.value[p.ywjzdm],p.caijishijian=$(p.caijishijian).format("YYYY-MM-DD HH:mm:ss"),p));f.value=E,e.current+=1,e.total=_.total,_.total<e.current*e.size&&(s.value=!0)}else _.statusCode==403&&(x.value=_.statusCode)}).catch(_=>{k.value=!0,s.value=!0}).finally(()=>{h.value=!1,g.value=!1})})};return _e(()=>{j(),W()}),(t,a)=>{const l=u("van-search"),R=u("van-field"),_=u("Selector"),E=u("van-button"),p=u("van-dropdown-item"),J=u("van-dropdown-menu"),K=u("van-sticky"),X=u("van-empty"),ee=u("van-skeleton"),ae=u("van-divider"),te=u("van-list"),le=u("van-pull-refresh"),ne=u("van-back-top");return m(),y(Y,null,[o(K,null,{default:c(()=>[o(l,{modelValue:n.value.biaoti,"onUpdate:modelValue":a[0]||(a[0]=d=>n.value.biaoti=d),"show-action":"",label:"标题",placeholder:"请输入标题关键词",onSearch:F},{action:c(()=>[C("div",{onClick:Z},"搜索")]),_:1},8,["modelValue"]),o(J,{ref:"menuRef"},{default:c(()=>[o(p,{title:"筛选",ref_key:"itemRef",ref:M},{default:c(()=>[o(R,{modelValue:n.value.neirong,"onUpdate:modelValue":a[1]||(a[1]=d=>n.value.neirong=d),label:"内容",placeholder:"请输入搜索关键词"},null,8,["modelValue"]),o(_,{modelValue:n.value.leixing,"onUpdate:modelValue":a[2]||(a[2]=d=>n.value.leixing=d),options:z.value,label:"采集类型",placeholder:"请点击选择"},null,8,["modelValue","options"]),o(_,{modelValue:n.value.laiyuan,"onUpdate:modelValue":a[3]||(a[3]=d=>n.value.laiyuan=d),options:A.value,label:"信息来源",placeholder:"请点击选择"},null,8,["modelValue","options"]),C("div",Se,[o(E,{type:"primary",block:"",onClick:V,style:{width:"49%"}},{default:c(()=>[b(" 重置 ")]),_:1}),o(E,{type:"primary",block:"",onClick:Q,style:{width:"49%"}},{default:c(()=>[b(" 查询 ")]),_:1})])]),_:1},512)]),_:1},512)]),_:1}),x.value===403?(m(),y("div",Te,[o(X,{image:pe(ke),"image-size":"250"},null,8,["image"]),Ae])):(m(),y("div",Le,[o(le,{modelValue:h.value,"onUpdate:modelValue":a[5]||(a[5]=d=>h.value=d),onRefresh:P,"success-text":"加载成功","loading-text":"加载中......"},{default:c(()=>[o(ee,{loading:g.value},null,8,["loading"]),g.value?I("",!0):(m(),y("div",Ue,[k.value?(m(),y("div",Ee,"加载失败，请重试")):(m(),y("div",Pe,[o(te,{loading:h.value,"onUpdate:loading":a[4]||(a[4]=d=>h.value=d),finished:s.value,offset:50,"finished-text":"",onLoad:j},{default:c(()=>[(m(!0),y(Y,null,me(f.value,(d,oe)=>(m(),ze(Ve,{key:oe,items:d},null,8,["items"]))),128)),s.value?(m(),y("div",Re,[o(ae,null,{default:c(()=>[b("到底了")]),_:1})])):I("",!0)]),_:1},8,["loading","finished"])]))]))]),_:1},8,["modelValue"])])),o(ne,{right:"15vw",bottom:"10vh"})],64)}}});const He=O(Ye,[["__scopeId","data-v-958bd93e"]]);export{He as default};
