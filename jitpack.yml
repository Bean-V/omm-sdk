jdk:
  - openjdk17

before_install:
  - chmod +x gradlew
  - sdk install java 17.0.12-oracle
  - sdk use java 17.0.12-oracle

install:
  # ========================================
  # JitPack 构建流程 - 多模块发布方案
  # ========================================
  
  # 步骤 1: 发布本地 AAR 文件到本地 Maven 仓库
  # 这些是 omm-lib/libs 目录中的第三方 AAR
  - ./gradlew publishLocalAarsToMavenLocal --no-configuration-cache -x test -x lint
  
  # 步骤 2: 构建所有子模块的 AAR
  # 确保所有 21 个子模块都已构建
  - ./gradlew assembleRelease --no-configuration-cache -x test -x lint
  
  # 步骤 3: 发布所有模块到 Maven Local
  # JitPack 会自动将 Maven Local 的内容发布到 JitPack 仓库
  # 这会发布 omm-lib + 所有 21 个子模块
  - ./gradlew publishToMavenLocal --no-configuration-cache -x test -x lint
  
  # ========================================
  # 预期结果
  # ========================================
  # ✅ 第三方只需一行依赖：
  #    implementation 'com.github.Bean-V:omm-sdk:2.0.0'
  # ✅ Gradle 自动解析所有 21 个子模块
  # ✅ Android 构建系统自动合并所有资源
  # ✅ 无需手动配置任何子模块依赖
  # ========================================